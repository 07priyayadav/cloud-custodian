<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>EC2 Policy Definition &mdash; Cloud Maid 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/style.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Cloud Maid 1.0 documentation" href="index.html" />
    <link rel="next" title="S3 Policies" href="s3.html" />
    <link rel="prev" title="Value Filters" href="filter-values.html" /> 
  </head>
  <body role="document">
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="index.html">Cloud Maid 1.0 documentation</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="filter-values.html" title="Value Filters"
             accesskey="P">previous</a> |
          <a href="s3.html" title="S3 Policies"
             accesskey="N">next</a> |
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="ec2-policy-definition">
<h1>EC2 Policy Definition<a class="headerlink" href="#ec2-policy-definition" title="Permalink to this headline">¶</a></h1>
<div class="section" id="filters">
<h2>Filters<a class="headerlink" href="#filters" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Standard Value Filter (see [Value Filters](filter-values.md))</li>
<li>Instance Age Filter</li>
</ul>
<p>The instance age filter allows for filtering the set of ec2 instances by
their LaunchTime, ie. all instances older than 60 or 90 days. The default
date value is 60 days if otherwise unspecified.</p>
</div>
<div class="section" id="filtering-examples">
<h2>Filtering Examples<a class="headerlink" href="#filtering-examples" title="Permalink to this headline">¶</a></h2>
<p>Configuring a specific value for instance-age to report all instances older
than 90 days.</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">policies</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">old-instances</span>
    <span class="l l-Scalar l-Scalar-Plain">resource</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="l l-Scalar l-Scalar-Plain">filters</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">instance-age</span>
      <span class="l l-Scalar l-Scalar-Plain">days</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">90</span>
</pre></div>
</div>
<p>Reporting all instances that are missing required tags</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">policies</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2-missing-tags</span>
    <span class="l l-Scalar l-Scalar-Plain">resource</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="l l-Scalar l-Scalar-Plain">filters</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;tag:ASV&quot;</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">absent</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;tag:CMDBEnvironment&quot;</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">absent</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;tag:OwnerContact&quot;</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">absent</span>
</pre></div>
</div>
</div>
<div class="section" id="actions">
<h2>Actions<a class="headerlink" href="#actions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="mark">
<h3>Mark<a class="headerlink" href="#mark" title="Permalink to this headline">¶</a></h3>
<p>Tag instances with mark instances matching filters with a &#8216;maid_status&#8217; tag by
default and configurable value.</p>
<p>Here&#8217;s an example of renaming an extant tag</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">policies</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2-tag-instances</span>
    <span class="l l-Scalar l-Scalar-Plain">resource</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="l l-Scalar l-Scalar-Plain">filters</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;tag:ASV&quot;</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">foobar</span>
    <span class="l l-Scalar l-Scalar-Plain">actions</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">mark</span>
        <span class="l l-Scalar l-Scalar-Plain">tag</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">ASV</span>
        <span class="l l-Scalar l-Scalar-Plain">msg</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">barrum</span>
</pre></div>
</div>
</div>
<div class="section" id="start">
<h3>Start<a class="headerlink" href="#start" title="Permalink to this headline">¶</a></h3>
<p>Start a set of instances (presumably) already stopped, the start action will automatically
filter instances to those that are already in the correct state.</p>
<p>This example will restart all stopped instances.</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">policies</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2-start</span>
    <span class="l l-Scalar l-Scalar-Plain">resources</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="l l-Scalar l-Scalar-Plain">actions</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">start</span>
</pre></div>
</div>
</div>
<div class="section" id="stop">
<h3>Stop<a class="headerlink" href="#stop" title="Permalink to this headline">¶</a></h3>
<p>Will stop the instances. Stopped instances do not incur ec2 instance costs.</p>
</div>
<div class="section" id="terminate">
<h3>Terminate<a class="headerlink" href="#terminate" title="Permalink to this headline">¶</a></h3>
<p>Will terminate the instances. Use with caution!</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer.html">Developer Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="lambda.html">CloudMaid Lambda Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="lambda.html#aws-cloud-config">AWS Cloud Config</a></li>
<li class="toctree-l1"><a class="reference internal" href="lambda.html#cloud-watch-events">Cloud Watch Events</a></li>
<li class="toctree-l1"><a class="reference internal" href="lambda.html#cloud-maid-integration">Cloud Maid Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="lambda.html#configuration">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="offhours.html">Offhours support</a></li>
<li class="toctree-l1"><a class="reference internal" href="offhours.html#tag-based-configuration">Tag Based Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="offhours.html#policy-examples">Policy examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="offhours.html#options">Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="filter-values.html">Value Filters</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">EC2 Policy Definition</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#filters">Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#filtering-examples">Filtering Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="#actions">Actions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="s3.html">S3 Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="comparisons.html">Comparisons</a></li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
            <p class="searchtip" style="font-size: 90%">
                Enter search terms or a module, class or function name.
            </p>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="filter-values.html" title="Value Filters"
              >previous</a> |
            <a href="s3.html" title="S3 Policies"
              >next</a> |
            <a href="py-modindex.html" title="Python Module Index"
              >modules</a> |
            <a href="genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
              <br/>
              <a href="_sources/ec2.txt"
                rel="nofollow">Show Source</a>
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, Kapil Thangavelu.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.3.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>