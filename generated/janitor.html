<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>janitor package &mdash; Cloud Maid 1.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Cloud Maid 1.0 documentation" href="../index.html" /> 
  </head>
  <body role="document">
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="../index.html">Cloud Maid 1.0 documentation</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="janitor-package">
<h1>janitor package<a class="headerlink" href="#janitor-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="janitor.resources.html">janitor.resources package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="janitor.resources.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="janitor.resources.html#module-janitor.resources.ami">janitor.resources.ami module</a></li>
<li class="toctree-l2"><a class="reference internal" href="janitor.resources.html#module-janitor.resources.asg">janitor.resources.asg module</a></li>
<li class="toctree-l2"><a class="reference internal" href="janitor.resources.html#module-janitor.resources.cfn">janitor.resources.cfn module</a></li>
<li class="toctree-l2"><a class="reference internal" href="janitor.resources.html#module-janitor.resources.ebs">janitor.resources.ebs module</a></li>
<li class="toctree-l2"><a class="reference internal" href="janitor.resources.html#module-janitor.resources.ec2">janitor.resources.ec2 module</a></li>
<li class="toctree-l2"><a class="reference internal" href="janitor.resources.html#module-janitor.resources.elb">janitor.resources.elb module</a></li>
<li class="toctree-l2"><a class="reference internal" href="janitor.resources.html#module-janitor.resources.kms">janitor.resources.kms module</a></li>
<li class="toctree-l2"><a class="reference internal" href="janitor.resources.html#module-janitor.resources.rds">janitor.resources.rds module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="janitor.resources.html#rds-resource-manager">RDS Resource Manager</a><ul>
<li class="toctree-l4"><a class="reference internal" href="janitor.resources.html#example-policies">Example Policies</a></li>
<li class="toctree-l4"><a class="reference internal" href="janitor.resources.html#todo-notes">Todo/Notes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="janitor.resources.html#module-janitor.resources.s3">janitor.resources.s3 module</a></li>
<li class="toctree-l2"><a class="reference internal" href="janitor.resources.html#module-janitor.resources">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-janitor.actions">
<span id="janitor-actions-module"></span><h2>janitor.actions module<a class="headerlink" href="#module-janitor.actions" title="Permalink to this headline">¶</a></h2>
<p>Actions to take on resources</p>
<dl class="class">
<dt id="janitor.actions.ActionRegistry">
<em class="property">class </em><code class="descclassname">janitor.actions.</code><code class="descname">ActionRegistry</code><span class="sig-paren">(</span><em>plugin_type</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/actions.html#ActionRegistry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.actions.ActionRegistry" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#janitor.registry.PluginRegistry" title="janitor.registry.PluginRegistry"><code class="xref py py-class docutils literal"><span class="pre">janitor.registry.PluginRegistry</span></code></a></p>
<dl class="method">
<dt id="janitor.actions.ActionRegistry.factory">
<code class="descname">factory</code><span class="sig-paren">(</span><em>data</em>, <em>manager</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.actions.ActionRegistry.factory" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.actions.ActionRegistry.parse">
<code class="descname">parse</code><span class="sig-paren">(</span><em>data</em>, <em>manager</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.actions.ActionRegistry.parse" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="janitor.actions.BaseAction">
<em class="property">class </em><code class="descclassname">janitor.actions.</code><code class="descname">BaseAction</code><span class="sig-paren">(</span><em>data=None</em>, <em>manager=None</em>, <em>log_dir=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/actions.html#BaseAction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.actions.BaseAction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="attribute">
<dt id="janitor.actions.BaseAction.executor_factory">
<code class="descname">executor_factory</code><a class="headerlink" href="#janitor.actions.BaseAction.executor_factory" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">ThreadPoolExecutor</span></code></p>
</dd></dl>

<dl class="method">
<dt id="janitor.actions.BaseAction.get_permissions">
<code class="descname">get_permissions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#janitor.actions.BaseAction.get_permissions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="janitor.actions.BaseAction.log">
<code class="descname">log</code><em class="property"> = &lt;logging.Logger object&gt;</em><a class="headerlink" href="#janitor.actions.BaseAction.log" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="janitor.actions.BaseAction.name">
<code class="descname">name</code><a class="headerlink" href="#janitor.actions.BaseAction.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="janitor.actions.BaseAction.permissions">
<code class="descname">permissions</code><em class="property"> = ()</em><a class="headerlink" href="#janitor.actions.BaseAction.permissions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.actions.BaseAction.process">
<code class="descname">process</code><span class="sig-paren">(</span><em>resources</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.actions.BaseAction.process" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.actions.BaseAction.validate">
<code class="descname">validate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#janitor.actions.BaseAction.validate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-janitor.cache">
<span id="janitor-cache-module"></span><h2>janitor.cache module<a class="headerlink" href="#module-janitor.cache" title="Permalink to this headline">¶</a></h2>
<p>Provide basic caching services to avoid extraneous
queries over multiple.</p>
<dl class="class">
<dt id="janitor.cache.FileCacheManager">
<em class="property">class </em><code class="descclassname">janitor.cache.</code><code class="descname">FileCacheManager</code><span class="sig-paren">(</span><em>config</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/cache.html#FileCacheManager"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.cache.FileCacheManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="janitor.cache.FileCacheManager.get">
<code class="descname">get</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.cache.FileCacheManager.get" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.cache.FileCacheManager.load">
<code class="descname">load</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#janitor.cache.FileCacheManager.load" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.cache.FileCacheManager.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>key</em>, <em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.cache.FileCacheManager.save" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="janitor.cache.NullCache">
<em class="property">class </em><code class="descclassname">janitor.cache.</code><code class="descname">NullCache</code><span class="sig-paren">(</span><em>config</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/cache.html#NullCache"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.cache.NullCache" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="janitor.cache.NullCache.get">
<code class="descname">get</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.cache.NullCache.get" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.cache.NullCache.load">
<code class="descname">load</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#janitor.cache.NullCache.load" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.cache.NullCache.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>key</em>, <em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.cache.NullCache.save" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="janitor.cache.factory">
<code class="descclassname">janitor.cache.</code><code class="descname">factory</code><span class="sig-paren">(</span><em>config</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/cache.html#factory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.cache.factory" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-janitor.cli">
<span id="janitor-cli-module"></span><h2>janitor.cli module<a class="headerlink" href="#module-janitor.cli" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="janitor.cli.main">
<code class="descclassname">janitor.cli.</code><code class="descname">main</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/cli.html#main"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.cli.main" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="janitor.cli.setup_parser">
<code class="descclassname">janitor.cli.</code><code class="descname">setup_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/cli.html#setup_parser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.cli.setup_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-janitor.commands">
<span id="janitor-commands-module"></span><h2>janitor.commands module<a class="headerlink" href="#module-janitor.commands" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="janitor.commands.identify">
<code class="descclassname">janitor.commands.</code><code class="descname">identify</code><span class="sig-paren">(</span><em>options</em>, <em>policy_collection</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/commands.html#identify"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.commands.identify" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="janitor.commands.report">
<code class="descclassname">janitor.commands.</code><code class="descname">report</code><span class="sig-paren">(</span><em>options</em>, <em>policy_collection</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/commands.html#report"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.commands.report" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="janitor.commands.run">
<code class="descclassname">janitor.commands.</code><code class="descname">run</code><span class="sig-paren">(</span><em>options</em>, <em>policy_collection</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/commands.html#run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.commands.run" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-janitor.credentials">
<span id="janitor-credentials-module"></span><h2>janitor.credentials module<a class="headerlink" href="#module-janitor.credentials" title="Permalink to this headline">¶</a></h2>
<p>Authentication utilities</p>
<dl class="class">
<dt id="janitor.credentials.SessionFactory">
<em class="property">class </em><code class="descclassname">janitor.credentials.</code><code class="descname">SessionFactory</code><span class="sig-paren">(</span><em>region</em>, <em>profile=None</em>, <em>assume_role=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/credentials.html#SessionFactory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.credentials.SessionFactory" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
</dd></dl>

<dl class="function">
<dt id="janitor.credentials.assumed_session">
<code class="descclassname">janitor.credentials.</code><code class="descname">assumed_session</code><span class="sig-paren">(</span><em>role_arn</em>, <em>session_name</em>, <em>session=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/credentials.html#assumed_session"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.credentials.assumed_session" title="Permalink to this definition">¶</a></dt>
<dd><p>STS Role assume a boto3.Session</p>
<p>With automatic credential renewal.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">role_arn: iam role arn to assume
session_name: client session identifier
session: an optional extant session, note session is captured</p>
<blockquote class="last">
<div>in a function closure for renewing the sts assumed role.</div></blockquote>
</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a boto3 session using the sts assumed role credentials</td>
</tr>
</tbody>
</table>
<p>Notes: We have to poke at botocore internals a few times</p>
</dd></dl>

</div>
<div class="section" id="module-janitor.ctx">
<span id="janitor-ctx-module"></span><h2>janitor.ctx module<a class="headerlink" href="#module-janitor.ctx" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="janitor.ctx.ExecutionContext">
<em class="property">class </em><code class="descclassname">janitor.ctx.</code><code class="descname">ExecutionContext</code><span class="sig-paren">(</span><em>session_factory</em>, <em>policy</em>, <em>options</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/ctx.html#ExecutionContext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.ctx.ExecutionContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Policy Execution Context.</p>
<dl class="attribute">
<dt id="janitor.ctx.ExecutionContext.log_dir">
<code class="descname">log_dir</code><a class="headerlink" href="#janitor.ctx.ExecutionContext.log_dir" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-janitor.executor">
<span id="janitor-executor-module"></span><h2>janitor.executor module<a class="headerlink" href="#module-janitor.executor" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="janitor.executor.ExecutorRegistry">
<em class="property">class </em><code class="descclassname">janitor.executor.</code><code class="descname">ExecutorRegistry</code><span class="sig-paren">(</span><em>plugin_type</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/executor.html#ExecutorRegistry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.executor.ExecutorRegistry" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#janitor.registry.PluginRegistry" title="janitor.registry.PluginRegistry"><code class="xref py py-class docutils literal"><span class="pre">janitor.registry.PluginRegistry</span></code></a></p>
</dd></dl>

<dl class="class">
<dt id="janitor.executor.MainThreadExecutor">
<em class="property">class </em><code class="descclassname">janitor.executor.</code><code class="descname">MainThreadExecutor</code><span class="sig-paren">(</span><em>*args</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/executor.html#MainThreadExecutor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.executor.MainThreadExecutor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="janitor.executor.MainThreadExecutor.map">
<code class="descname">map</code><span class="sig-paren">(</span><em>func</em>, <em>iterable</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.executor.MainThreadExecutor.map" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.executor.MainThreadExecutor.submit">
<code class="descname">submit</code><span class="sig-paren">(</span><em>func</em>, <em>*args</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.executor.MainThreadExecutor.submit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="janitor.executor.MainThreadFuture">
<em class="property">class </em><code class="descclassname">janitor.executor.</code><code class="descname">MainThreadFuture</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/executor.html#MainThreadFuture"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.executor.MainThreadFuture" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="janitor.executor.MainThreadFuture.add_done_callback">
<code class="descname">add_done_callback</code><span class="sig-paren">(</span><em>fn</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.executor.MainThreadFuture.add_done_callback" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.executor.MainThreadFuture.cancel">
<code class="descname">cancel</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#janitor.executor.MainThreadFuture.cancel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.executor.MainThreadFuture.cancelled">
<code class="descname">cancelled</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#janitor.executor.MainThreadFuture.cancelled" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.executor.MainThreadFuture.done">
<code class="descname">done</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#janitor.executor.MainThreadFuture.done" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.executor.MainThreadFuture.exception">
<code class="descname">exception</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#janitor.executor.MainThreadFuture.exception" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.executor.MainThreadFuture.result">
<code class="descname">result</code><span class="sig-paren">(</span><em>timeout=None</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.executor.MainThreadFuture.result" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="janitor.executor.executor">
<code class="descclassname">janitor.executor.</code><code class="descname">executor</code><span class="sig-paren">(</span><em>name</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/executor.html#executor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.executor.executor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-janitor.filters">
<span id="janitor-filters-module"></span><h2>janitor.filters module<a class="headerlink" href="#module-janitor.filters" title="Permalink to this headline">¶</a></h2>
<p>Resource Filtering Logic</p>
<dl class="class">
<dt id="janitor.filters.AgeFilter">
<em class="property">class </em><code class="descclassname">janitor.filters.</code><code class="descname">AgeFilter</code><span class="sig-paren">(</span><em>data</em>, <em>manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/filters.html#AgeFilter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.filters.AgeFilter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#janitor.filters.Filter" title="janitor.filters.Filter"><code class="xref py py-class docutils literal"><span class="pre">janitor.filters.Filter</span></code></a></p>
<p>Automatically filter resources older than a given date.</p>
<dl class="attribute">
<dt id="janitor.filters.AgeFilter.date_attribute">
<code class="descname">date_attribute</code><em class="property"> = None</em><a class="headerlink" href="#janitor.filters.AgeFilter.date_attribute" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.filters.AgeFilter.get_resource_date">
<code class="descname">get_resource_date</code><span class="sig-paren">(</span><em>i</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/filters.html#AgeFilter.get_resource_date"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.filters.AgeFilter.get_resource_date" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="janitor.filters.AgeFilter.threshold_date">
<code class="descname">threshold_date</code><em class="property"> = None</em><a class="headerlink" href="#janitor.filters.AgeFilter.threshold_date" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.filters.AgeFilter.validate">
<code class="descname">validate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/filters.html#AgeFilter.validate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.filters.AgeFilter.validate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="janitor.filters.And">
<em class="property">class </em><code class="descclassname">janitor.filters.</code><code class="descname">And</code><span class="sig-paren">(</span><em>data</em>, <em>registry</em>, <em>manager</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/filters.html#And"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.filters.And" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#janitor.filters.Filter" title="janitor.filters.Filter"><code class="xref py py-class docutils literal"><span class="pre">janitor.filters.Filter</span></code></a></p>
</dd></dl>

<dl class="class">
<dt id="janitor.filters.EventFilter">
<em class="property">class </em><code class="descclassname">janitor.filters.</code><code class="descname">EventFilter</code><span class="sig-paren">(</span><em>data</em>, <em>manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/filters.html#EventFilter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.filters.EventFilter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#janitor.filters.ValueFilter" title="janitor.filters.ValueFilter"><code class="xref py py-class docutils literal"><span class="pre">janitor.filters.ValueFilter</span></code></a></p>
<dl class="method">
<dt id="janitor.filters.EventFilter.process">
<code class="descname">process</code><span class="sig-paren">(</span><em>resources</em>, <em>event=None</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.filters.EventFilter.process" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="janitor.filters.Filter">
<em class="property">class </em><code class="descclassname">janitor.filters.</code><code class="descname">Filter</code><span class="sig-paren">(</span><em>data</em>, <em>manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/filters.html#Filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.filters.Filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="attribute">
<dt id="janitor.filters.Filter.executor_factory">
<code class="descname">executor_factory</code><a class="headerlink" href="#janitor.filters.Filter.executor_factory" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">ThreadPoolExecutor</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="janitor.filters.Filter.log">
<code class="descname">log</code><em class="property"> = &lt;logging.Logger object&gt;</em><a class="headerlink" href="#janitor.filters.Filter.log" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="janitor.filters.Filter.name">
<code class="descname">name</code><a class="headerlink" href="#janitor.filters.Filter.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the filter</p>
</dd></dl>

<dl class="method">
<dt id="janitor.filters.Filter.process">
<code class="descname">process</code><span class="sig-paren">(</span><em>resources</em>, <em>event=None</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.filters.Filter.process" title="Permalink to this definition">¶</a></dt>
<dd><p>Bulk process resources and return filtered set.</p>
</dd></dl>

<dl class="method">
<dt id="janitor.filters.Filter.validate">
<code class="descname">validate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#janitor.filters.Filter.validate" title="Permalink to this definition">¶</a></dt>
<dd><p>validate filter config, return validation error or self</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="janitor.filters.FilterRegistry">
<em class="property">class </em><code class="descclassname">janitor.filters.</code><code class="descname">FilterRegistry</code><span class="sig-paren">(</span><em>*args</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/filters.html#FilterRegistry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.filters.FilterRegistry" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#janitor.registry.PluginRegistry" title="janitor.registry.PluginRegistry"><code class="xref py py-class docutils literal"><span class="pre">janitor.registry.PluginRegistry</span></code></a></p>
<dl class="method">
<dt id="janitor.filters.FilterRegistry.factory">
<code class="descname">factory</code><span class="sig-paren">(</span><em>data</em>, <em>manager=None</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.filters.FilterRegistry.factory" title="Permalink to this definition">¶</a></dt>
<dd><p>Factory func for filters.</p>
<p>data - policy config for filters
manager - resource type manager (ec2, s3, etc)</p>
</dd></dl>

<dl class="method">
<dt id="janitor.filters.FilterRegistry.parse">
<code class="descname">parse</code><span class="sig-paren">(</span><em>data</em>, <em>manager</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.filters.FilterRegistry.parse" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="exception">
<dt id="janitor.filters.FilterValidationError">
<em class="property">exception </em><code class="descclassname">janitor.filters.</code><code class="descname">FilterValidationError</code><a class="reference internal" href="../_modules/janitor/filters.html#FilterValidationError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.filters.FilterValidationError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></code></p>
</dd></dl>

<dl class="class">
<dt id="janitor.filters.MarkedForOp">
<em class="property">class </em><code class="descclassname">janitor.filters.</code><code class="descname">MarkedForOp</code><span class="sig-paren">(</span><em>data</em>, <em>manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/filters.html#MarkedForOp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.filters.MarkedForOp" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#janitor.filters.Filter" title="janitor.filters.Filter"><code class="xref py py-class docutils literal"><span class="pre">janitor.filters.Filter</span></code></a></p>
<dl class="attribute">
<dt id="janitor.filters.MarkedForOp.current_date">
<code class="descname">current_date</code><em class="property"> = None</em><a class="headerlink" href="#janitor.filters.MarkedForOp.current_date" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="janitor.filters.MarkedForOp.log">
<code class="descname">log</code><em class="property"> = &lt;logging.Logger object&gt;</em><a class="headerlink" href="#janitor.filters.MarkedForOp.log" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="janitor.filters.Or">
<em class="property">class </em><code class="descclassname">janitor.filters.</code><code class="descname">Or</code><span class="sig-paren">(</span><em>data</em>, <em>registry</em>, <em>manager</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/filters.html#Or"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.filters.Or" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#janitor.filters.Filter" title="janitor.filters.Filter"><code class="xref py py-class docutils literal"><span class="pre">janitor.filters.Filter</span></code></a></p>
</dd></dl>

<dl class="class">
<dt id="janitor.filters.ValueFilter">
<em class="property">class </em><code class="descclassname">janitor.filters.</code><code class="descname">ValueFilter</code><span class="sig-paren">(</span><em>data</em>, <em>manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/filters.html#ValueFilter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.filters.ValueFilter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#janitor.filters.Filter" title="janitor.filters.Filter"><code class="xref py py-class docutils literal"><span class="pre">janitor.filters.Filter</span></code></a></p>
<p>Generic value filter using jmespath</p>
<dl class="attribute">
<dt id="janitor.filters.ValueFilter.expr">
<code class="descname">expr</code><em class="property"> = None</em><a class="headerlink" href="#janitor.filters.ValueFilter.expr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.filters.ValueFilter.match">
<code class="descname">match</code><span class="sig-paren">(</span><em>i</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/filters.html#ValueFilter.match"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.filters.ValueFilter.match" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="janitor.filters.ValueFilter.op">
<code class="descname">op</code><em class="property"> = None</em><a class="headerlink" href="#janitor.filters.ValueFilter.op" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="janitor.filters.ValueFilter.v">
<code class="descname">v</code><em class="property"> = None</em><a class="headerlink" href="#janitor.filters.ValueFilter.v" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.filters.ValueFilter.validate">
<code class="descname">validate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/filters.html#ValueFilter.validate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.filters.ValueFilter.validate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-janitor.mailer">
<span id="janitor-mailer-module"></span><h2>janitor.mailer module<a class="headerlink" href="#module-janitor.mailer" title="Permalink to this headline">¶</a></h2>
<div class="section" id="sqs-email-relay">
<h3>SQS Email Relay<a class="headerlink" href="#sqs-email-relay" title="Permalink to this headline">¶</a></h3>
<p>Designed to work around ... corporate silliness. Rather than sending
email directly to users from maid via ses or other saas api, we
currently have to send via email relay.</p>
<p>Which prevents our lambda functions (separate magic vpc) from being
able to send email. Instead (and for other reasons not appropriate to
describe here) we send email via sqs for an email relay worker to
pickup and push out via smtp.</p>
<p>But as they say every problem is an opportunity, and this
gives us an opportunity to batch our emails within a given
time window to a given recipient.</p>
<p>From a connection perspective it looks like this</p>
<dl class="docutils">
<dt>Maid (on instance) &#8211;</dt>
<dd><blockquote class="first">
<div>&#8212; SQS Queue &#8211; Relay Worker -&gt; SMTP</div></blockquote>
<p class="last">/</p>
</dd>
</dl>
<p>Maid (lambda)  &#8212;&#8211;</p>
<p>Operationally we can work in either of two modes</p>
<blockquote>
<div><ul class="simple">
<li>Fetch Formatted Email Message off Queue and send via relay</li>
<li>Fetch Structured Message and batch for interval, before
coalescing on address, and sending outbound email.</li>
</ul>
</div></blockquote>
<div class="section" id="proposed-usage">
<h4>Proposed Usage<a class="headerlink" href="#proposed-usage" title="Permalink to this headline">¶</a></h4>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">policies</span><span class="p p-Indicator">:</span>
   <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2-tag-compliance</span>
     <span class="l l-Scalar l-Scalar-Plain">resource</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
     <span class="l l-Scalar l-Scalar-Plain">filters</span><span class="p p-Indicator">:</span>
       <span class="p p-Indicator">-</span> <span class="s">&quot;tag:required&quot;</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">absent</span>
     <span class="l l-Scalar l-Scalar-Plain">actions</span><span class="p p-Indicator">:</span>
       <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">notify</span>
         <span class="l l-Scalar l-Scalar-Plain">target</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">owner</span>
         <span class="l l-Scalar l-Scalar-Plain">owner-tags</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">OwnerContact, OwnerEmail</span>
         <span class="l l-Scalar l-Scalar-Plain">delivery</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">ses</span>
</pre></div>
</div>
</div>
<div class="section" id="data-message-structure">
<h4>Data Message Structure<a class="headerlink" href="#data-message-structure" title="Permalink to this headline">¶</a></h4>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">resource_type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
  <span class="l l-Scalar l-Scalar-Plain">message</span><span class="p p-Indicator">:</span> <span class="s">&quot;&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">resources</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span>
    <span class="p p-Indicator">{</span><span class="s">&#39;InstanceId&#39;</span><span class="p p-Indicator">:</span> <span class="s">&#39;xyz&#39;</span><span class="p p-Indicator">},</span>
  <span class="p p-Indicator">]</span>
</pre></div>
</div>
<p>We&#8217;ll receive those and queue them up. And then at batch
period we&#8217;ll do outbound formatting and processing</p>
</div>
<div class="section" id="email-message-structure">
<h4>Email Message Structure<a class="headerlink" href="#email-message-structure" title="Permalink to this headline">¶</a></h4>
<p>We also want direct formatted emails, these are not batched
and are directly sent out as received in simple relay fashion.</p>
<blockquote>
<div><ul class="simple">
<li>{&#8216;recipient&#8217;: &#8216;subject&#8217;:  &#8216;body&#8217;: base64(gzip())&#8217;}</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="todo">
<h4>Todo<a class="headerlink" href="#todo" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><ul class="simple">
<li>Bounce processing</li>
</ul>
</div></blockquote>
<dl class="class">
<dt id="janitor.mailer.EmailFormatter">
<em class="property">class </em><code class="descclassname">janitor.mailer.</code><code class="descname">EmailFormatter</code><span class="sig-paren">(</span><em>config</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mailer.html#EmailFormatter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mailer.EmailFormatter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Given a group of data messages for a given recipient
construct a formatted email message.</p>
<dl class="method">
<dt id="janitor.mailer.EmailFormatter.format">
<code class="descname">format</code><span class="sig-paren">(</span><em>recipient</em>, <em>batch</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mailer.html#EmailFormatter.format"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mailer.EmailFormatter.format" title="Permalink to this definition">¶</a></dt>
<dd><p>Format a batch of messages to a single recipient</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="janitor.mailer.MessageAddress">
<em class="property">class </em><code class="descclassname">janitor.mailer.</code><code class="descname">MessageAddress</code><a class="reference internal" href="../_modules/janitor/mailer.html#MessageAddress"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mailer.MessageAddress" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="attribute">
<dt id="janitor.mailer.MessageAddress.Email">
<code class="descname">Email</code><em class="property"> = 'Email'</em><a class="headerlink" href="#janitor.mailer.MessageAddress.Email" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="janitor.mailer.MessageAddress.Lookup">
<code class="descname">Lookup</code><em class="property"> = 'Lookup'</em><a class="headerlink" href="#janitor.mailer.MessageAddress.Lookup" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="janitor.mailer.MessageAddress.Topic">
<code class="descname">Topic</code><em class="property"> = 'SNS'</em><a class="headerlink" href="#janitor.mailer.MessageAddress.Topic" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="janitor.mailer.MessageAddress.address_resolver">
<em class="property">static </em><code class="descname">address_resolver</code><span class="sig-paren">(</span><em>contact</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.mailer.MessageAddress.address_resolver" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="janitor.mailer.MessageDB">
<em class="property">class </em><code class="descclassname">janitor.mailer.</code><code class="descname">MessageDB</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mailer.html#MessageDB"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mailer.MessageDB" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="janitor.mailer.MessageDB.add">
<code class="descname">add</code><span class="sig-paren">(</span><em>recipient</em>, <em>message</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.mailer.MessageDB.add" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.mailer.MessageDB.batches">
<code class="descname">batches</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#janitor.mailer.MessageDB.batches" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.mailer.MessageDB.flush">
<code class="descname">flush</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#janitor.mailer.MessageDB.flush" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="janitor.mailer.Worker">
<em class="property">class </em><code class="descclassname">janitor.mailer.</code><code class="descname">Worker</code><span class="sig-paren">(</span><em>config</em>, <em>session_factory</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mailer.html#Worker"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mailer.Worker" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="janitor.mailer.Worker.run">
<code class="descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#janitor.mailer.Worker.run" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="janitor.mailer.send_data_message">
<code class="descclassname">janitor.mailer.</code><code class="descname">send_data_message</code><span class="sig-paren">(</span><em>queue_url</em>, <em>recipient</em>, <em>message</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mailer.html#send_data_message"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mailer.send_data_message" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="janitor.mailer.send_email_message">
<code class="descclassname">janitor.mailer.</code><code class="descname">send_email_message</code><span class="sig-paren">(</span><em>client</em>, <em>queue_url</em>, <em>message</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mailer.html#send_email_message"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mailer.send_email_message" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="janitor.mailer.setup_parser">
<code class="descclassname">janitor.mailer.</code><code class="descname">setup_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mailer.html#setup_parser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mailer.setup_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</div>
</div>
<div class="section" id="module-janitor.manager">
<span id="janitor-manager-module"></span><h2>janitor.manager module<a class="headerlink" href="#module-janitor.manager" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="janitor.manager.ResourceManager">
<em class="property">class </em><code class="descclassname">janitor.manager.</code><code class="descname">ResourceManager</code><span class="sig-paren">(</span><em>ctx</em>, <em>data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/manager.html#ResourceManager"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.manager.ResourceManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="janitor.manager.ResourceManager.filter_resources">
<code class="descname">filter_resources</code><span class="sig-paren">(</span><em>resources</em>, <em>event=None</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.manager.ResourceManager.filter_resources" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.manager.ResourceManager.format_json">
<code class="descname">format_json</code><span class="sig-paren">(</span><em>resources</em>, <em>fh</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.manager.ResourceManager.format_json" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.manager.ResourceManager.get_resources">
<code class="descname">get_resources</code><span class="sig-paren">(</span><em>resource_ids</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.manager.ResourceManager.get_resources" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.manager.ResourceManager.resource_query">
<code class="descname">resource_query</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#janitor.manager.ResourceManager.resource_query" title="Permalink to this definition">¶</a></dt>
<dd><p>Return server side query filter for the given api.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="janitor-mode-module">
<h2>janitor.mode module<a class="headerlink" href="#janitor-mode-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-janitor.mu">
<span id="janitor-mu-module"></span><h2>janitor.mu module<a class="headerlink" href="#module-janitor.mu" title="Permalink to this headline">¶</a></h2>
<div class="section" id="lambda-support">
<h3>Lambda Support<a class="headerlink" href="#lambda-support" title="Permalink to this headline">¶</a></h3>
<p>Lambda provides for powerful realtime and near realtime compliance
execution when integrated in with a number of different amazon
services as event sources.</p>
<div class="section" id="aws-cloud-config">
<h4>AWS Cloud Config<a class="headerlink" href="#aws-cloud-config" title="Permalink to this headline">¶</a></h4>
<p>One event source is using AWS Cloud Config, which provides versioned
json representation of objects into s3 with rules execution against
them.  Config Rules allow for lambda execution against these resource
states to determine compliance along with a nice dashboard targeted
towards visualizing compliance information over time. At the moment
config rules execute after the resource is already active, based on the
underlying resource poll and config snapshot delivery.</p>
<p>Underlying the hood aws config and config rules, appear to be just
productizing a poll of some resources into json files in s3 with
lambda and versioned metrics reports. At the moment config rules
only support items managed under the ec2 api (ec2, ebs, network) which
means they have significant coverage gap when looking at the totality
of aws services since they only cover a single api. As a result atm,
they are best suited to orgs that are using a small subset of aws that
requires audit (ie. just ec2) and prefer a pre-configured dashboard on
that subset. Of course overtime the config service will evolve.</p>
<p>However for capabilities and reporting around compliance Netflix
security monkey would be a better choice atm imo. Maid distinguishes
in its configurable policy engine, as opposed to hard coded, ability
to run serverless, better integration with current best aws practices
and provides remediation and enforcement capabilities.</p>
<p>Open question on config rules, Its unclear if rules execute against
only on a delta to a resource or against each config snapshot..</p>
<p>For a wider range of coverage and functionality we turn to</p>
</div>
<div class="section" id="cloud-watch-events">
<h4>Cloud Watch Events<a class="headerlink" href="#cloud-watch-events" title="Permalink to this headline">¶</a></h4>
<p>Cloud watchs events is a general event bus for aws infrastructure, atm
it covers two major sources of information, real time instance status events
and cloud trail api calls over a poll period on cloud trail delivery.</p>
<p>Cloud trail provides a much richer data source over the entire range
of aws services exposed via the audit trail to enable defining
compliance policy effectively against any aws product.</p>
<p>Additionally for ec2 instances we can provide mandatory policy
compliance, that effectively means the non compliant resource never
became available.</p>
</div>
<div class="section" id="cloud-maid-integration">
<h4>Cloud Maid Integration<a class="headerlink" href="#cloud-maid-integration" title="Permalink to this headline">¶</a></h4>
<p>Maid provides for policy level execution against any lambda subscribable
event stream.</p>
<p>We reconstitue current state for the given resource and execute
the policy against it, matching against the policy filters, and applying
the policy actions.</p>
<p>Mu is the letter after lambda, lambda is a keyword in python.</p>
</div>
<div class="section" id="configuration">
<h4>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h4>
<p>Examples</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">policies</span><span class="p p-Indicator">:</span>

  <span class="c1"># Cloud Watch Events over CloudTrail api calls (1-15m trailing)</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2-tag-compliance</span>
    <span class="l l-Scalar l-Scalar-Plain">mode</span><span class="p p-Indicator">:</span> 
      <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">cloudtrail</span>
      <span class="l l-Scalar l-Scalar-Plain">sources</span><span class="p p-Indicator">:</span> 
       <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ec2.amazonaws.com</span>
      <span class="l l-Scalar l-Scalar-Plain">events</span><span class="p p-Indicator">:</span> 
       <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">RunInstances</span>
      <span class="c1"># For cloud trail events we need to reference the resources id</span>
      <span class="l l-Scalar l-Scalar-Plain">resources</span><span class="p p-Indicator">:</span> <span class="s">&quot;detail.responseElements.instancesSet.items[].instanceId&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">filters</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">or</span><span class="p p-Indicator">:</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">tag:required1</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">absent</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">tag:required2</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">absent</span>
    <span class="l l-Scalar l-Scalar-Plain">actions</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">stop</span>

  <span class="c1"># On EC2 Instance state events (real time, seconds)</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2-require-encrypted-volumes</span>
    <span class="l l-Scalar l-Scalar-Plain">mode</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2-instance-state</span>
      <span class="l l-Scalar l-Scalar-Plain">events</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">pending</span>
    <span class="l l-Scalar l-Scalar-Plain">filters</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">ebs</span>
        <span class="l l-Scalar l-Scalar-Plain">key</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Encrypted</span>
        <span class="l l-Scalar l-Scalar-Plain">value</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">False</span>
    <span class="l l-Scalar l-Scalar-Plain">actions</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">mark</span>
      <span class="c1"># TODO delete instance volumes that</span>
      <span class="c1"># are not set to delete on terminate</span>
      <span class="c1"># currently we have a poll policy that</span>
      <span class="c1"># handles this.</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">terminate</span>

  <span class="c1"># Periodic Function</span>
  <span class="c1"># Syntax for scheduler per http://goo.gl/x3oMQ4</span>
  <span class="c1"># Supports both rate per unit time and cron expressions</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">s3-bucket-check</span>
    <span class="l l-Scalar l-Scalar-Plain">resource</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">s3</span>
    <span class="l l-Scalar l-Scalar-Plain">mode</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">periodic</span>
      <span class="l l-Scalar l-Scalar-Plain">schedule</span><span class="p p-Indicator">:</span> <span class="s">&quot;rate(1</span><span class="nv"> </span><span class="s">day)&quot;</span>
</pre></div>
</div>
<dl class="class">
<dt id="janitor.mu.CloudWatchEventSource">
<em class="property">class </em><code class="descclassname">janitor.mu.</code><code class="descname">CloudWatchEventSource</code><span class="sig-paren">(</span><em>data</em>, <em>session_factory</em>, <em>prefix='maid-'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mu.html#CloudWatchEventSource"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mu.CloudWatchEventSource" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Modeled loosely after kappa event source, such that it can be contributed
post cloudwatch events ga or public beta.</p>
<p>Event Pattern for Instance State</p>
<div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span> 
  <span class="nt">&quot;source&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;aws.ec2&quot;</span><span class="p">],</span>
  <span class="nt">&quot;detail-type&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;EC2 Instance State-change Notification&quot;</span><span class="p">],</span>
  <span class="nt">&quot;detail&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;state&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;pending&quot;</span><span class="p">]}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Event Pattern for Cloud Trail API</p>
<div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;detail-type&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;AWS API Call via CloudTrail&quot;</span><span class="p">],</span>
  <span class="nt">&quot;detail&quot;</span><span class="p">:</span> <span class="p">{</span>
     <span class="nt">&quot;eventSource&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;s3.amazonaws.com&quot;</span><span class="p">],</span>
     <span class="nt">&quot;eventName&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;CreateBucket&quot;</span><span class="p">,</span> <span class="s2">&quot;DeleteBucket&quot;</span><span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="janitor.mu.CloudWatchEventSource.ASG_EVENT_MAPPING">
<code class="descname">ASG_EVENT_MAPPING</code><em class="property"> = {'launch-success': 'EC2 Instance Launch Successful', 'terminate-success': 'EC2 Instance Terminate Successful', 'terminate-failure': 'EC2 Instance Terminate Unsuccessful', 'launch-failure': 'EC2 Instance Launch Unsuccessful'}</em><a class="headerlink" href="#janitor.mu.CloudWatchEventSource.ASG_EVENT_MAPPING" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.mu.CloudWatchEventSource.add">
<code class="descname">add</code><span class="sig-paren">(</span><em>func</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mu.html#CloudWatchEventSource.add"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mu.CloudWatchEventSource.add" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.mu.CloudWatchEventSource.delta">
<code class="descname">delta</code><span class="sig-paren">(</span><em>src</em>, <em>tgt</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mu.html#CloudWatchEventSource.delta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mu.CloudWatchEventSource.delta" title="Permalink to this definition">¶</a></dt>
<dd><p>Given two cwe rules determine if the configuration is the same.</p>
<p>Name is already implied.</p>
</dd></dl>

<dl class="method">
<dt id="janitor.mu.CloudWatchEventSource.get">
<code class="descname">get</code><span class="sig-paren">(</span><em>rule_name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mu.html#CloudWatchEventSource.get"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mu.CloudWatchEventSource.get" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.mu.CloudWatchEventSource.pause">
<code class="descname">pause</code><span class="sig-paren">(</span><em>func</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mu.html#CloudWatchEventSource.pause"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mu.CloudWatchEventSource.pause" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.mu.CloudWatchEventSource.remove">
<code class="descname">remove</code><span class="sig-paren">(</span><em>func</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mu.html#CloudWatchEventSource.remove"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mu.CloudWatchEventSource.remove" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.mu.CloudWatchEventSource.render_event_pattern">
<code class="descname">render_event_pattern</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mu.html#CloudWatchEventSource.render_event_pattern"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mu.CloudWatchEventSource.render_event_pattern" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.mu.CloudWatchEventSource.resume">
<code class="descname">resume</code><span class="sig-paren">(</span><em>func</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mu.html#CloudWatchEventSource.resume"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mu.CloudWatchEventSource.resume" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.mu.CloudWatchEventSource.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>func</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mu.html#CloudWatchEventSource.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mu.CloudWatchEventSource.update" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="janitor.mu.Config">
<em class="property">class </em><code class="descclassname">janitor.mu.</code><code class="descname">Config</code><a class="reference internal" href="../_modules/janitor/mu.html#Config"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mu.Config" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">dict</span></code></p>
<dl class="classmethod">
<dt id="janitor.mu.Config.empty">
<em class="property">classmethod </em><code class="descname">empty</code><span class="sig-paren">(</span><em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.mu.Config.empty" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="janitor.mu.LambdaFunction">
<em class="property">class </em><code class="descclassname">janitor.mu.</code><code class="descname">LambdaFunction</code><a class="reference internal" href="../_modules/janitor/mu.html#LambdaFunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mu.LambdaFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="attribute">
<dt id="janitor.mu.LambdaFunction.alias">
<code class="descname">alias</code><em class="property"> = None</em><a class="headerlink" href="#janitor.mu.LambdaFunction.alias" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="janitor.mu.LambdaFunction.description">
<code class="descname">description</code><a class="headerlink" href="#janitor.mu.LambdaFunction.description" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.mu.LambdaFunction.get_archive">
<code class="descname">get_archive</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#janitor.mu.LambdaFunction.get_archive" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the lambda distribution archive object.</p>
</dd></dl>

<dl class="method">
<dt id="janitor.mu.LambdaFunction.get_events">
<code class="descname">get_events</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#janitor.mu.LambdaFunction.get_events" title="Permalink to this definition">¶</a></dt>
<dd><p>event sources that should be bound to this lambda.</p>
</dd></dl>

<dl class="attribute">
<dt id="janitor.mu.LambdaFunction.handler">
<code class="descname">handler</code><a class="headerlink" href="#janitor.mu.LambdaFunction.handler" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="janitor.mu.LambdaFunction.memory_size">
<code class="descname">memory_size</code><a class="headerlink" href="#janitor.mu.LambdaFunction.memory_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="janitor.mu.LambdaFunction.name">
<code class="descname">name</code><a class="headerlink" href="#janitor.mu.LambdaFunction.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name for the lambda function</p>
</dd></dl>

<dl class="attribute">
<dt id="janitor.mu.LambdaFunction.role">
<code class="descname">role</code><a class="headerlink" href="#janitor.mu.LambdaFunction.role" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="janitor.mu.LambdaFunction.runtime">
<code class="descname">runtime</code><a class="headerlink" href="#janitor.mu.LambdaFunction.runtime" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="janitor.mu.LambdaFunction.timeout">
<code class="descname">timeout</code><a class="headerlink" href="#janitor.mu.LambdaFunction.timeout" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="janitor.mu.LambdaManager">
<em class="property">class </em><code class="descclassname">janitor.mu.</code><code class="descname">LambdaManager</code><span class="sig-paren">(</span><em>session_factory</em>, <em>s3_asset_path=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mu.html#LambdaManager"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mu.LambdaManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Provides CRUD operations around lambda functions</p>
<dl class="method">
<dt id="janitor.mu.LambdaManager.get">
<code class="descname">get</code><span class="sig-paren">(</span><em>func_name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mu.html#LambdaManager.get"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mu.LambdaManager.get" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.mu.LambdaManager.list_functions">
<code class="descname">list_functions</code><span class="sig-paren">(</span><em>prefix=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mu.html#LambdaManager.list_functions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mu.LambdaManager.list_functions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.mu.LambdaManager.publish">
<code class="descname">publish</code><span class="sig-paren">(</span><em>func</em>, <em>alias=None</em>, <em>role=None</em>, <em>s3_uri=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mu.html#LambdaManager.publish"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mu.LambdaManager.publish" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.mu.LambdaManager.publish_alias">
<code class="descname">publish_alias</code><span class="sig-paren">(</span><em>func_data</em>, <em>alias</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mu.html#LambdaManager.publish_alias"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mu.LambdaManager.publish_alias" title="Permalink to this definition">¶</a></dt>
<dd><p>Create or update an alias for the given function.</p>
</dd></dl>

<dl class="method">
<dt id="janitor.mu.LambdaManager.remove">
<code class="descname">remove</code><span class="sig-paren">(</span><em>func</em>, <em>alias=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mu.html#LambdaManager.remove"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mu.LambdaManager.remove" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="janitor.mu.PolicyLambda">
<em class="property">class </em><code class="descclassname">janitor.mu.</code><code class="descname">PolicyLambda</code><span class="sig-paren">(</span><em>policy</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mu.html#PolicyLambda"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mu.PolicyLambda" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#janitor.mu.LambdaFunction" title="janitor.mu.LambdaFunction"><code class="xref py py-class docutils literal"><span class="pre">janitor.mu.LambdaFunction</span></code></a></p>
<dl class="attribute">
<dt id="janitor.mu.PolicyLambda.description">
<code class="descname">description</code><a class="headerlink" href="#janitor.mu.PolicyLambda.description" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.mu.PolicyLambda.get_archive">
<code class="descname">get_archive</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#janitor.mu.PolicyLambda.get_archive" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.mu.PolicyLambda.get_events">
<code class="descname">get_events</code><span class="sig-paren">(</span><em>session_factory</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.mu.PolicyLambda.get_events" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="janitor.mu.PolicyLambda.handler">
<code class="descname">handler</code><em class="property"> = 'maid_policy.run'</em><a class="headerlink" href="#janitor.mu.PolicyLambda.handler" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="janitor.mu.PolicyLambda.memory_size">
<code class="descname">memory_size</code><a class="headerlink" href="#janitor.mu.PolicyLambda.memory_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="janitor.mu.PolicyLambda.name">
<code class="descname">name</code><a class="headerlink" href="#janitor.mu.PolicyLambda.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="janitor.mu.PolicyLambda.role">
<code class="descname">role</code><a class="headerlink" href="#janitor.mu.PolicyLambda.role" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="janitor.mu.PolicyLambda.runtime">
<code class="descname">runtime</code><em class="property"> = 'python2.7'</em><a class="headerlink" href="#janitor.mu.PolicyLambda.runtime" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="janitor.mu.PolicyLambda.timeout">
<code class="descname">timeout</code><em class="property"> = 60</em><a class="headerlink" href="#janitor.mu.PolicyLambda.timeout" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="janitor.mu.PythonPackageArchive">
<em class="property">class </em><code class="descclassname">janitor.mu.</code><code class="descname">PythonPackageArchive</code><span class="sig-paren">(</span><em>src_path</em>, <em>virtualenv_dir</em>, <em>skip=None</em>, <em>lib_filter=None</em>, <em>src_filter=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mu.html#PythonPackageArchive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mu.PythonPackageArchive" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Creates a zip file for python lambda functions</p>
<p>Packages up a virtualenv and a source package directory per lambda&#8217;s
directory structure.</p>
<dl class="method">
<dt id="janitor.mu.PythonPackageArchive.add_contents">
<code class="descname">add_contents</code><span class="sig-paren">(</span><em>dest</em>, <em>contents</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mu.html#PythonPackageArchive.add_contents"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mu.PythonPackageArchive.add_contents" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.mu.PythonPackageArchive.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mu.html#PythonPackageArchive.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mu.PythonPackageArchive.close" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.mu.PythonPackageArchive.create">
<code class="descname">create</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mu.html#PythonPackageArchive.create"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mu.PythonPackageArchive.create" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.mu.PythonPackageArchive.filter_files">
<code class="descname">filter_files</code><span class="sig-paren">(</span><em>files</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mu.html#PythonPackageArchive.filter_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mu.PythonPackageArchive.filter_files" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.mu.PythonPackageArchive.get_bytes">
<code class="descname">get_bytes</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mu.html#PythonPackageArchive.get_bytes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mu.PythonPackageArchive.get_bytes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="janitor.mu.PythonPackageArchive.path">
<code class="descname">path</code><a class="headerlink" href="#janitor.mu.PythonPackageArchive.path" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.mu.PythonPackageArchive.remove">
<code class="descname">remove</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mu.html#PythonPackageArchive.remove"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mu.PythonPackageArchive.remove" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="janitor.mu.PythonPackageArchive.size">
<code class="descname">size</code><a class="headerlink" href="#janitor.mu.PythonPackageArchive.size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="janitor.mu.cloudtrail_handle">
<code class="descclassname">janitor.mu.</code><code class="descname">cloudtrail_handle</code><span class="sig-paren">(</span><em>event</em>, <em>context</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mu.html#cloudtrail_handle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mu.cloudtrail_handle" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="janitor.mu.ec2_instance_state_handle">
<code class="descclassname">janitor.mu.</code><code class="descname">ec2_instance_state_handle</code><span class="sig-paren">(</span><em>event</em>, <em>context</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mu.html#ec2_instance_state_handle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mu.ec2_instance_state_handle" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="janitor.mu.format_event">
<code class="descclassname">janitor.mu.</code><code class="descname">format_event</code><span class="sig-paren">(</span><em>evt</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mu.html#format_event"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mu.format_event" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="janitor.mu.maid_archive">
<code class="descclassname">janitor.mu.</code><code class="descname">maid_archive</code><span class="sig-paren">(</span><em>skip=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mu.html#maid_archive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mu.maid_archive" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a lambda code archive for running maid.</p>
</dd></dl>

<dl class="function">
<dt id="janitor.mu.periodic_handle">
<code class="descclassname">janitor.mu.</code><code class="descname">periodic_handle</code><span class="sig-paren">(</span><em>event</em>, <em>context</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mu.html#periodic_handle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mu.periodic_handle" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="janitor.mu.resource_exists">
<code class="descclassname">janitor.mu.</code><code class="descname">resource_exists</code><span class="sig-paren">(</span><em>op</em>, <em>*args</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mu.html#resource_exists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mu.resource_exists" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="janitor.mu.resource_handle">
<code class="descclassname">janitor.mu.</code><code class="descname">resource_handle</code><span class="sig-paren">(</span><em>event</em>, <em>lambda_context</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mu.html#resource_handle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mu.resource_handle" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic resource handler dispatch</p>
</dd></dl>

<dl class="function">
<dt id="janitor.mu.zinfo">
<code class="descclassname">janitor.mu.</code><code class="descname">zinfo</code><span class="sig-paren">(</span><em>fname</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/mu.html#zinfo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.mu.zinfo" title="Permalink to this definition">¶</a></dt>
<dd><p>Amazon lambda exec environment setup can break itself
if zip files aren&#8217;t constructed a particular way.</p>
<p>ie. It respects file perm attributes including
those that prevent lambda from working. Namely lambda
extracts code as one user, and executes code as a different
user without permissions for the executing user to read
the file the lambda function is defacto broken.</p>
<p>Python&#8217;s default zipfile.writestr does a 0600 perm which
we modify here as a workaround.</p>
</dd></dl>

</div>
</div>
</div>
<div class="section" id="module-janitor.offhours">
<span id="janitor-offhours-module"></span><h2>janitor.offhours module<a class="headerlink" href="#module-janitor.offhours" title="Permalink to this headline">¶</a></h2>
<div class="section" id="offhours-support">
<h3>Offhours support<a class="headerlink" href="#offhours-support" title="Permalink to this headline">¶</a></h3>
<p>Turn instances off based on typical hours not in use. Also supports
one time use instances for quickly trying something out, but wanting
to turn terminate it after a length of time (like one week, one month, 
etc).</p>
<p>By default, Off hours support is based on tags being defined on
applicable resources.</p>
</div>
<div class="section" id="tag-based-configuration">
<h3>Tag Based Configuration<a class="headerlink" href="#tag-based-configuration" title="Permalink to this headline">¶</a></h3>
<p>Note the tag name is configurable per policy configuration, examples below use
default tag name, ie. maid_downtime.</p>
<ul class="simple">
<li>maid_offhours:</li>
</ul>
<p>An empty tag value implies night and weekend offhours using the default
time zone configured in the policy (tz=est if unspecified).</p>
<ul class="simple">
<li>maid_offhours: tz=pt</li>
</ul>
<p>Note all timezone aliases are referenced to a locality to ensure taking into
account local daylight savings time (if any).</p>
<ul class="simple">
<li>maid_offhours: tz=Americas/Los_Angeles</li>
</ul>
<p>A geography can be specified but must be in the time zone database.</p>
<p>Per <a class="reference external" href="http://www.iana.org/time-zones">http://www.iana.org/time-zones</a></p>
<ul class="simple">
<li>maid_offhours: off</li>
</ul>
<p>If offhours is configured to run in opt-out mode, this tag can be specified
to disable offhours on a given instance.</p>
<p>Terminate after time period</p>
<ul class="simple">
<li>maid_offhours: terminate 1w</li>
<li>maid_offhours: terminate 3d</li>
<li>maid_offhours: terminate 3h</li>
</ul>
</div>
<div class="section" id="policy-examples">
<h3>Policy examples<a class="headerlink" href="#policy-examples" title="Permalink to this headline">¶</a></h3>
<p>Turn ec2 instances on and off</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">policies</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">offhours-stop</span>
    <span class="l l-Scalar l-Scalar-Plain">resource</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="l l-Scalar l-Scalar-Plain">filters</span><span class="p p-Indicator">:</span>
       <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">offhours</span>
    <span class="l l-Scalar l-Scalar-Plain">actions</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">stop</span>

  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">offhours-start</span>
    <span class="l l-Scalar l-Scalar-Plain">resource</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="l l-Scalar l-Scalar-Plain">filters</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">onhours</span>
    <span class="l l-Scalar l-Scalar-Plain">actions</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">start</span>
</pre></div>
</div>
</div>
<div class="section" id="options">
<h3>Options<a class="headerlink" href="#options" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>tag: the tag name to use when configuring</li>
<li>default_tz: the default timezone to use when interpreting offhours</li>
<li>offhour: the time to turn instances off, specified in 0-24</li>
<li>onhour: the time to turn instances on, specified in 0-24</li>
</ul>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">policies</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">offhours-stop</span>
    <span class="l l-Scalar l-Scalar-Plain">resource</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">ec2</span>
    <span class="l l-Scalar l-Scalar-Plain">filters</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">offhours</span>
        <span class="l l-Scalar l-Scalar-Plain">tag</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">downtime</span>
        <span class="l l-Scalar l-Scalar-Plain">onhour</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">8</span>
        <span class="l l-Scalar l-Scalar-Plain">offhour</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">20</span>
</pre></div>
</div>
<dl class="class">
<dt id="janitor.offhours.OffHour">
<em class="property">class </em><code class="descclassname">janitor.offhours.</code><code class="descname">OffHour</code><span class="sig-paren">(</span><em>data</em>, <em>manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/offhours.html#OffHour"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.offhours.OffHour" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#janitor.offhours.Time" title="janitor.offhours.Time"><code class="xref py py-class docutils literal"><span class="pre">janitor.offhours.Time</span></code></a></p>
<dl class="method">
<dt id="janitor.offhours.OffHour.get_sentinel_time">
<code class="descname">get_sentinel_time</code><span class="sig-paren">(</span><em>tz</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.offhours.OffHour.get_sentinel_time" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="janitor.offhours.OnHour">
<em class="property">class </em><code class="descclassname">janitor.offhours.</code><code class="descname">OnHour</code><span class="sig-paren">(</span><em>data</em>, <em>manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/offhours.html#OnHour"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.offhours.OnHour" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#janitor.offhours.Time" title="janitor.offhours.Time"><code class="xref py py-class docutils literal"><span class="pre">janitor.offhours.Time</span></code></a></p>
<dl class="method">
<dt id="janitor.offhours.OnHour.get_sentinel_time">
<code class="descname">get_sentinel_time</code><span class="sig-paren">(</span><em>tz</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.offhours.OnHour.get_sentinel_time" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="janitor.offhours.Time">
<em class="property">class </em><code class="descclassname">janitor.offhours.</code><code class="descname">Time</code><span class="sig-paren">(</span><em>data</em>, <em>manager=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/offhours.html#Time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.offhours.Time" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#janitor.filters.Filter" title="janitor.filters.Filter"><code class="xref py py-class docutils literal"><span class="pre">janitor.filters.Filter</span></code></a></p>
<dl class="method">
<dt id="janitor.offhours.Time.get_local_tz">
<code class="descname">get_local_tz</code><span class="sig-paren">(</span><em>parts</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.offhours.Time.get_local_tz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.offhours.Time.get_sentinel_time">
<code class="descname">get_sentinel_time</code><span class="sig-paren">(</span><em>tz</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.offhours.Time.get_sentinel_time" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.offhours.Time.get_tag_parts">
<code class="descname">get_tag_parts</code><span class="sig-paren">(</span><em>i</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.offhours.Time.get_tag_parts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.offhours.Time.process_current_time">
<code class="descname">process_current_time</code><span class="sig-paren">(</span><em>i</em>, <em>parts</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.offhours.Time.process_current_time" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.offhours.Time.process_terminate">
<code class="descname">process_terminate</code><span class="sig-paren">(</span><em>i</em>, <em>parts</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.offhours.Time.process_terminate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-janitor.output">
<span id="janitor-output-module"></span><h2>janitor.output module<a class="headerlink" href="#module-janitor.output" title="Permalink to this headline">¶</a></h2>
<div class="section" id="record-outputs">
<h3>Record Outputs<a class="headerlink" href="#record-outputs" title="Permalink to this headline">¶</a></h3>
<p>Structured and Unstructured per action and resource</p>
<ul class="simple">
<li>Python Execution Log</li>
<li>Policy Resource Records</li>
<li>Policy Action Records</li>
<li>CloudWatch Metrics</li>
<li>CloudWatch Logs</li>
</ul>
</div>
<div class="section" id="s3-bucket-location">
<h3>S3 Bucket Location<a class="headerlink" href="#s3-bucket-location" title="Permalink to this headline">¶</a></h3>
<p>For structured and unstructured data, we store to s3.</p>
<p>s3://cloud-maid-sts-digital-dev/</p>
<p>policies</p>
<ul class="simple">
<li>&lt;policy-name&gt;<ul>
<li>&lt;date&gt;<ul>
<li>&lt;file.log.gz&gt;<ul>
<li>&lt;file.json.gz&gt;</li>
<li>maid</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Actions have output / or even state to store
in local directories that is then uploaded.</p>
<p>Every policy gets a temp directory for fs output.</p>
<ul class="simple">
<li>maid-run.log.gz</li>
</ul>
<dl class="class">
<dt id="janitor.output.CloudWatchLogOutput">
<em class="property">class </em><code class="descclassname">janitor.output.</code><code class="descname">CloudWatchLogOutput</code><span class="sig-paren">(</span><em>ctx</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/output.html#CloudWatchLogOutput"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.output.CloudWatchLogOutput" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#janitor.output.LogOutput" title="janitor.output.LogOutput"><code class="xref py py-class docutils literal"><span class="pre">janitor.output.LogOutput</span></code></a></p>
<dl class="method">
<dt id="janitor.output.CloudWatchLogOutput.get_handler">
<code class="descname">get_handler</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#janitor.output.CloudWatchLogOutput.get_handler" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="janitor.output.CloudWatchLogOutput.log_format">
<code class="descname">log_format</code><em class="property"> = '%(levelname)s - %(name)s - %(message)s'</em><a class="headerlink" href="#janitor.output.CloudWatchLogOutput.log_format" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="janitor.output.DirectoryOutput">
<em class="property">class </em><code class="descclassname">janitor.output.</code><code class="descname">DirectoryOutput</code><span class="sig-paren">(</span><em>ctx</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/output.html#DirectoryOutput"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.output.DirectoryOutput" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#janitor.output.FSOutput" title="janitor.output.FSOutput"><code class="xref py py-class docutils literal"><span class="pre">janitor.output.FSOutput</span></code></a></p>
<dl class="attribute">
<dt id="janitor.output.DirectoryOutput.permissions">
<code class="descname">permissions</code><em class="property"> = ()</em><a class="headerlink" href="#janitor.output.DirectoryOutput.permissions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="janitor.output.FSOutput">
<em class="property">class </em><code class="descclassname">janitor.output.</code><code class="descname">FSOutput</code><span class="sig-paren">(</span><em>ctx</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/output.html#FSOutput"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.output.FSOutput" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#janitor.output.LogOutput" title="janitor.output.LogOutput"><code class="xref py py-class docutils literal"><span class="pre">janitor.output.LogOutput</span></code></a></p>
<dl class="method">
<dt id="janitor.output.FSOutput.compress">
<code class="descname">compress</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#janitor.output.FSOutput.compress" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.output.FSOutput.get_handler">
<code class="descname">get_handler</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#janitor.output.FSOutput.get_handler" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="janitor.output.FSOutput.join">
<em class="property">static </em><code class="descname">join</code><span class="sig-paren">(</span><em>*parts</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.output.FSOutput.join" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="janitor.output.FSOutput.select">
<em class="property">static </em><code class="descname">select</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.output.FSOutput.select" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="janitor.output.LogOutput">
<em class="property">class </em><code class="descclassname">janitor.output.</code><code class="descname">LogOutput</code><span class="sig-paren">(</span><em>ctx</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/output.html#LogOutput"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.output.LogOutput" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="janitor.output.LogOutput.get_handler">
<code class="descname">get_handler</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#janitor.output.LogOutput.get_handler" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.output.LogOutput.join_log">
<code class="descname">join_log</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#janitor.output.LogOutput.join_log" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.output.LogOutput.leave_log">
<code class="descname">leave_log</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#janitor.output.LogOutput.leave_log" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="janitor.output.LogOutput.log_format">
<code class="descname">log_format</code><em class="property"> = '%(asctime)s - %(name)s - %(levelname)s - %(message)s'</em><a class="headerlink" href="#janitor.output.LogOutput.log_format" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="janitor.output.MetricsOutput">
<em class="property">class </em><code class="descclassname">janitor.output.</code><code class="descname">MetricsOutput</code><span class="sig-paren">(</span><em>ctx</em>, <em>namespace='CloudMaid'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/output.html#MetricsOutput"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.output.MetricsOutput" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Send metrics data to cloudwatch</p>
<dl class="method">
<dt id="janitor.output.MetricsOutput.flush">
<code class="descname">flush</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/output.html#MetricsOutput.flush"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.output.MetricsOutput.flush" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="janitor.output.MetricsOutput.permissions">
<code class="descname">permissions</code><em class="property"> = ('cloudWatch:PutMetricData',)</em><a class="headerlink" href="#janitor.output.MetricsOutput.permissions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.output.MetricsOutput.put_metric">
<code class="descname">put_metric</code><span class="sig-paren">(</span><em>key</em>, <em>value</em>, <em>unit</em>, <em>buffer=False</em>, <em>**dimensions</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/output.html#MetricsOutput.put_metric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.output.MetricsOutput.put_metric" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="janitor.output.MetricsOutput.select">
<em class="property">static </em><code class="descname">select</code><span class="sig-paren">(</span><em>metrics_enabled</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/output.html#MetricsOutput.select"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.output.MetricsOutput.select" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="janitor.output.NullMetricsOutput">
<em class="property">class </em><code class="descclassname">janitor.output.</code><code class="descname">NullMetricsOutput</code><span class="sig-paren">(</span><em>ctx</em>, <em>namespace='CloudMaid'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/output.html#NullMetricsOutput"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.output.NullMetricsOutput" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#janitor.output.MetricsOutput" title="janitor.output.MetricsOutput"><code class="xref py py-class docutils literal"><span class="pre">janitor.output.MetricsOutput</span></code></a></p>
<dl class="method">
<dt id="janitor.output.NullMetricsOutput.format_metric">
<code class="descname">format_metric</code><span class="sig-paren">(</span><em>m</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.output.NullMetricsOutput.format_metric" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="janitor.output.NullMetricsOutput.permissions">
<code class="descname">permissions</code><em class="property"> = ()</em><a class="headerlink" href="#janitor.output.NullMetricsOutput.permissions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="janitor.output.S3Output">
<em class="property">class </em><code class="descclassname">janitor.output.</code><code class="descname">S3Output</code><span class="sig-paren">(</span><em>ctx</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/output.html#S3Output"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.output.S3Output" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#janitor.output.FSOutput" title="janitor.output.FSOutput"><code class="xref py py-class docutils literal"><span class="pre">janitor.output.FSOutput</span></code></a></p>
<p>Usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">S3Output</span><span class="p">(</span><span class="n">session_factory</span><span class="p">,</span> <span class="s1">&#39;s3://bucket/prefix&#39;</span><span class="p">):</span>
    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;xyz&#39;</span><span class="p">)</span>  <span class="c1"># -&gt; log messages sent to maid-run.log.gz</span>
</pre></div>
</div>
<dl class="staticmethod">
<dt id="janitor.output.S3Output.join">
<em class="property">static </em><code class="descname">join</code><span class="sig-paren">(</span><em>*parts</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/output.html#S3Output.join"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.output.S3Output.join" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="janitor.output.S3Output.permissions">
<code class="descname">permissions</code><em class="property"> = ('S3:PutObject',)</em><a class="headerlink" href="#janitor.output.S3Output.permissions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.output.S3Output.upload">
<code class="descname">upload</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/output.html#S3Output.upload"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.output.S3Output.upload" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="janitor.output.s3_join">
<code class="descclassname">janitor.output.</code><code class="descname">s3_join</code><span class="sig-paren">(</span><em>*parts</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.output.s3_join" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</div>
<div class="section" id="module-janitor.policy">
<span id="janitor-policy-module"></span><h2>janitor.policy module<a class="headerlink" href="#module-janitor.policy" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="janitor.policy.Policy">
<em class="property">class </em><code class="descclassname">janitor.policy.</code><code class="descname">Policy</code><span class="sig-paren">(</span><em>data</em>, <em>options</em>, <em>session_factory=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/policy.html#Policy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.policy.Policy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="janitor.policy.Policy.get_resource_manager">
<code class="descname">get_resource_manager</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#janitor.policy.Policy.get_resource_manager" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="janitor.policy.Policy.is_lambda">
<code class="descname">is_lambda</code><a class="headerlink" href="#janitor.policy.Policy.is_lambda" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="janitor.policy.Policy.log">
<code class="descname">log</code><em class="property"> = &lt;logging.Logger object&gt;</em><a class="headerlink" href="#janitor.policy.Policy.log" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="janitor.policy.Policy.name">
<code class="descname">name</code><a class="headerlink" href="#janitor.policy.Policy.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.policy.Policy.poll">
<code class="descname">poll</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#janitor.policy.Policy.poll" title="Permalink to this definition">¶</a></dt>
<dd><p>Query resources and apply policy.</p>
</dd></dl>

<dl class="method">
<dt id="janitor.policy.Policy.provision">
<code class="descname">provision</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#janitor.policy.Policy.provision" title="Permalink to this definition">¶</a></dt>
<dd><p>Provision policy as a lambda function.</p>
</dd></dl>

<dl class="method">
<dt id="janitor.policy.Policy.push">
<code class="descname">push</code><span class="sig-paren">(</span><em>event</em>, <em>lambda_ctx</em>, <em>resources</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.policy.Policy.push" title="Permalink to this definition">¶</a></dt>
<dd><p>Run policy in push mode against given event.</p>
<p>Lambda automatically generates cloud watch logs, and metrics
for us.</p>
<p>TODO: better customization around execution context outputs
TODO: support centralized lambda exec across accounts.</p>
</dd></dl>

<dl class="attribute">
<dt id="janitor.policy.Policy.resource_type">
<code class="descname">resource_type</code><a class="headerlink" href="#janitor.policy.Policy.resource_type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.policy.Policy.run">
<code class="descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#janitor.policy.Policy.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run policy in default mode</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="janitor.policy.PolicyCollection">
<em class="property">class </em><code class="descclassname">janitor.policy.</code><code class="descname">PolicyCollection</code><span class="sig-paren">(</span><em>data</em>, <em>options</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/policy.html#PolicyCollection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.policy.PolicyCollection" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="janitor.policy.PolicyCollection.policies">
<code class="descname">policies</code><span class="sig-paren">(</span><em>filters=None</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.policy.PolicyCollection.policies" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="janitor.policy.load">
<code class="descclassname">janitor.policy.</code><code class="descname">load</code><span class="sig-paren">(</span><em>options</em>, <em>path</em>, <em>format='yaml'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/policy.html#load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.policy.load" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-janitor.registry">
<span id="janitor-registry-module"></span><h2>janitor.registry module<a class="headerlink" href="#module-janitor.registry" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="janitor.registry.PluginRegistry">
<em class="property">class </em><code class="descclassname">janitor.registry.</code><code class="descname">PluginRegistry</code><span class="sig-paren">(</span><em>plugin_type</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/registry.html#PluginRegistry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.registry.PluginRegistry" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>A plugin registry</p>
<p>Maid is intended to be innately pluggable both internally and
externally, for resource types and their filters and actions.</p>
<p>This plugin registry abstraction provides the core mechanism for
that. Its a simple string to class map, with python package
entry_point loading for external plugins.</p>
<p>As an example of defining an external plugin using a python package</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">setup</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;maid_cmdb&quot;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Maid filters for interacting with internal CMDB&quot;</span>
    <span class="n">version</span><span class="o">=</span><span class="s1">&#39;1.0&#39;</span><span class="p">,</span>
    <span class="n">packages</span><span class="o">=</span><span class="n">find_packages</span><span class="p">(),</span>
    <span class="n">entry_points</span><span class="o">=</span><span class="p">{</span>
         <span class="s1">&#39;console_scripts&#39;</span><span class="p">:</span> <span class="p">[</span>
              <span class="s1">&#39;maid.ec2.filters = maid_cmdb:filter_ec2&#39;</span><span class="p">]},</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>For loading the plugins we can simply invoke method:load_plugins like
so:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">PluginRegistry</span><span class="p">(</span><span class="s1">&#39;ec2.filters&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">load_plugins</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="janitor.registry.PluginRegistry.get">
<code class="descname">get</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/registry.html#PluginRegistry.get"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.registry.PluginRegistry.get" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.registry.PluginRegistry.keys">
<code class="descname">keys</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/registry.html#PluginRegistry.keys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.registry.PluginRegistry.keys" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.registry.PluginRegistry.load_plugins">
<code class="descname">load_plugins</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/registry.html#PluginRegistry.load_plugins"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.registry.PluginRegistry.load_plugins" title="Permalink to this definition">¶</a></dt>
<dd><p>Load external plugins.</p>
<p>Maid is intended to interact with internal and external systems
that are not suitable for embedding into the maid code base.</p>
</dd></dl>

<dl class="method">
<dt id="janitor.registry.PluginRegistry.register">
<code class="descname">register</code><span class="sig-paren">(</span><em>name</em>, <em>klass=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/registry.html#PluginRegistry.register"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.registry.PluginRegistry.register" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.registry.PluginRegistry.unregister">
<code class="descname">unregister</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/registry.html#PluginRegistry.unregister"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.registry.PluginRegistry.unregister" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-janitor.report">
<span id="janitor-report-module"></span><h2>janitor.report module<a class="headerlink" href="#module-janitor.report" title="Permalink to this headline">¶</a></h2>
<div class="section" id="reporting-tools">
<h3>Reporting Tools<a class="headerlink" href="#reporting-tools" title="Permalink to this headline">¶</a></h3>
<p>Provides reporting tools against cloud-maid&#8217;s json output records.</p>
<p>For each policy execution maid stores structured output
in json format of the records a policy has filtered to
in an s3 bucket.</p>
<p>These represent the records matching the policy filters
that the policy will apply actions to.</p>
<p>The reporting mechanism here simply fetches those records
over a given time interval and constructs a resource type
specific report on them.</p>
<div class="section" id="cli-usage">
<h4>CLI Usage<a class="headerlink" href="#cli-usage" title="Permalink to this headline">¶</a></h4>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ cloud-maid report -s s3://cloud-maid-xyz/policies <span class="se">\</span>
  -p ec2-tag-compliance-terminate -v &gt; terminated.csv
</pre></div>
</div>
<p>TODO</p>
<p>The type specific formatting needs easy customization, 
a config file for the report or maid, or named formats
with format spec on the cli are all viable.</p>
<dl class="class">
<dt id="janitor.report.ASGFormatter">
<em class="property">class </em><code class="descclassname">janitor.report.</code><code class="descname">ASGFormatter</code><a class="reference internal" href="../_modules/janitor/report.html#ASGFormatter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.report.ASGFormatter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#janitor.report.Formatter" title="janitor.report.Formatter"><code class="xref py py-class docutils literal"><span class="pre">janitor.report.Formatter</span></code></a></p>
<dl class="method">
<dt id="janitor.report.ASGFormatter.csv_fields">
<code class="descname">csv_fields</code><span class="sig-paren">(</span><em>record</em>, <em>tag_map</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/report.html#ASGFormatter.csv_fields"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.report.ASGFormatter.csv_fields" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="janitor.report.EC2Formatter">
<em class="property">class </em><code class="descclassname">janitor.report.</code><code class="descname">EC2Formatter</code><a class="reference internal" href="../_modules/janitor/report.html#EC2Formatter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.report.EC2Formatter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#janitor.report.Formatter" title="janitor.report.Formatter"><code class="xref py py-class docutils literal"><span class="pre">janitor.report.Formatter</span></code></a></p>
<dl class="method">
<dt id="janitor.report.EC2Formatter.csv_fields">
<code class="descname">csv_fields</code><span class="sig-paren">(</span><em>record</em>, <em>tag_map</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/report.html#EC2Formatter.csv_fields"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.report.EC2Formatter.csv_fields" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.report.EC2Formatter.filter_record">
<code class="descname">filter_record</code><span class="sig-paren">(</span><em>record</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/report.html#EC2Formatter.filter_record"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.report.EC2Formatter.filter_record" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="janitor.report.Formatter">
<em class="property">class </em><code class="descclassname">janitor.report.</code><code class="descname">Formatter</code><span class="sig-paren">(</span><em>id_field</em>, <em>headers</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/report.html#Formatter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.report.Formatter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="janitor.report.Formatter.csv_fields">
<code class="descname">csv_fields</code><span class="sig-paren">(</span><em>record</em>, <em>tag_map</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/report.html#Formatter.csv_fields"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.report.Formatter.csv_fields" title="Permalink to this definition">¶</a></dt>
<dd><p>Must be implemented by subclass</p>
</dd></dl>

<dl class="method">
<dt id="janitor.report.Formatter.extract_csv">
<code class="descname">extract_csv</code><span class="sig-paren">(</span><em>record</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/report.html#Formatter.extract_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.report.Formatter.extract_csv" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.report.Formatter.filter_record">
<code class="descname">filter_record</code><span class="sig-paren">(</span><em>record</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/report.html#Formatter.filter_record"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.report.Formatter.filter_record" title="Permalink to this definition">¶</a></dt>
<dd><p>Override in subclass if filtering needed.</p>
</dd></dl>

<dl class="method">
<dt id="janitor.report.Formatter.headers">
<code class="descname">headers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/report.html#Formatter.headers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.report.Formatter.headers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.report.Formatter.to_csv">
<code class="descname">to_csv</code><span class="sig-paren">(</span><em>records</em>, <em>reverse=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/report.html#Formatter.to_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.report.Formatter.to_csv" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.report.Formatter.uniq_by_id">
<code class="descname">uniq_by_id</code><span class="sig-paren">(</span><em>records</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/report.html#Formatter.uniq_by_id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.report.Formatter.uniq_by_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Only the first record for each id</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="janitor.report.fs_record_set">
<code class="descclassname">janitor.report.</code><code class="descname">fs_record_set</code><span class="sig-paren">(</span><em>output_path</em>, <em>policy_name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/report.html#fs_record_set"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.report.fs_record_set" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="janitor.report.get_records">
<code class="descclassname">janitor.report.</code><code class="descname">get_records</code><span class="sig-paren">(</span><em>bucket</em>, <em>key</em>, <em>session_factory</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/report.html#get_records"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.report.get_records" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="janitor.report.record_set">
<code class="descclassname">janitor.report.</code><code class="descname">record_set</code><span class="sig-paren">(</span><em>session_factory</em>, <em>bucket</em>, <em>key_prefix</em>, <em>start_date</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/report.html#record_set"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.report.record_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve all s3 records for the given policy output url</p>
<p>From the given start date.</p>
</dd></dl>

<dl class="function">
<dt id="janitor.report.report">
<code class="descclassname">janitor.report.</code><code class="descname">report</code><span class="sig-paren">(</span><em>policy</em>, <em>start_date</em>, <em>output_fh</em>, <em>raw_output_fh=None</em>, <em>filters=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/report.html#report"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.report.report" title="Permalink to this definition">¶</a></dt>
<dd><p>Format a policy&#8217;s extant records into a report.</p>
</dd></dl>

</div>
</div>
</div>
<div class="section" id="module-janitor.sqsexec">
<span id="janitor-sqsexec-module"></span><h2>janitor.sqsexec module<a class="headerlink" href="#module-janitor.sqsexec" title="Permalink to this headline">¶</a></h2>
<p>concurrent.futures implementation over sqs</p>
<p>Scatter/Gather or Map/Reduce style over two sqs queues.</p>
<dl class="class">
<dt id="janitor.sqsexec.MessageIterator">
<em class="property">class </em><code class="descclassname">janitor.sqsexec.</code><code class="descname">MessageIterator</code><span class="sig-paren">(</span><em>client</em>, <em>queue_url</em>, <em>limit=0</em>, <em>timeout=10</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/sqsexec.html#MessageIterator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.sqsexec.MessageIterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="janitor.sqsexec.MessageIterator.ack">
<code class="descname">ack</code><span class="sig-paren">(</span><em>m</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.sqsexec.MessageIterator.ack" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="janitor.sqsexec.MessageIterator.msg_attributes">
<code class="descname">msg_attributes</code><em class="property"> = ['sequence_id', 'op', 'ser']</em><a class="headerlink" href="#janitor.sqsexec.MessageIterator.msg_attributes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.sqsexec.MessageIterator.next">
<code class="descname">next</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#janitor.sqsexec.MessageIterator.next" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="janitor.sqsexec.SQSExecutor">
<em class="property">class </em><code class="descclassname">janitor.sqsexec.</code><code class="descname">SQSExecutor</code><span class="sig-paren">(</span><em>session_factory</em>, <em>map_queue</em>, <em>reduce_queue</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/sqsexec.html#SQSExecutor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.sqsexec.SQSExecutor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">concurrent.futures._base.Executor</span></code></p>
<dl class="method">
<dt id="janitor.sqsexec.SQSExecutor.gather">
<code class="descname">gather</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#janitor.sqsexec.SQSExecutor.gather" title="Permalink to this definition">¶</a></dt>
<dd><p>Fetch results from separate queue</p>
</dd></dl>

<dl class="method">
<dt id="janitor.sqsexec.SQSExecutor.submit">
<code class="descname">submit</code><span class="sig-paren">(</span><em>func</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.sqsexec.SQSExecutor.submit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="janitor.sqsexec.SQSFuture">
<em class="property">class </em><code class="descclassname">janitor.sqsexec.</code><code class="descname">SQSFuture</code><span class="sig-paren">(</span><em>sequence_id</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/sqsexec.html#SQSFuture"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.sqsexec.SQSFuture" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">concurrent.futures._base.Future</span></code></p>
<dl class="attribute">
<dt id="janitor.sqsexec.SQSFuture.marker">
<code class="descname">marker</code><em class="property"> = &lt;object object&gt;</em><a class="headerlink" href="#janitor.sqsexec.SQSFuture.marker" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="janitor.sqsexec.SQSWorker">
<em class="property">class </em><code class="descclassname">janitor.sqsexec.</code><code class="descname">SQSWorker</code><span class="sig-paren">(</span><em>session_factory</em>, <em>map_queue</em>, <em>reduce_queue</em>, <em>limit=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/sqsexec.html#SQSWorker"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.sqsexec.SQSWorker" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="janitor.sqsexec.SQSWorker.process_message">
<code class="descname">process_message</code><span class="sig-paren">(</span><em>m</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.sqsexec.SQSWorker.process_message" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.sqsexec.SQSWorker.run">
<code class="descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#janitor.sqsexec.SQSWorker.run" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="janitor.sqsexec.SQSWorker.stop">
<code class="descname">stop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#janitor.sqsexec.SQSWorker.stop" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="janitor.sqsexec.SQSWorker.stopped">
<code class="descname">stopped</code><em class="property"> = False</em><a class="headerlink" href="#janitor.sqsexec.SQSWorker.stopped" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="janitor.sqsexec.named">
<code class="descclassname">janitor.sqsexec.</code><code class="descname">named</code><span class="sig-paren">(</span><em>o</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/sqsexec.html#named"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.sqsexec.named" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="janitor.sqsexec.resolve">
<code class="descclassname">janitor.sqsexec.</code><code class="descname">resolve</code><span class="sig-paren">(</span><em>o</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/sqsexec.html#resolve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.sqsexec.resolve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-janitor.utils">
<span id="janitor-utils-module"></span><h2>janitor.utils module<a class="headerlink" href="#module-janitor.utils" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="janitor.utils.DateTimeEncoder">
<em class="property">class </em><code class="descclassname">janitor.utils.</code><code class="descname">DateTimeEncoder</code><span class="sig-paren">(</span><em>skipkeys=False</em>, <em>ensure_ascii=True</em>, <em>check_circular=True</em>, <em>allow_nan=True</em>, <em>sort_keys=False</em>, <em>indent=None</em>, <em>separators=None</em>, <em>encoding='utf-8'</em>, <em>default=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/utils.html#DateTimeEncoder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.utils.DateTimeEncoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">json.encoder.JSONEncoder</span></code></p>
<dl class="method">
<dt id="janitor.utils.DateTimeEncoder.default">
<code class="descname">default</code><span class="sig-paren">(</span><em>obj</em><span class="sig-paren">)</span><a class="headerlink" href="#janitor.utils.DateTimeEncoder.default" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="janitor.utils.annotation">
<code class="descclassname">janitor.utils.</code><code class="descname">annotation</code><span class="sig-paren">(</span><em>i</em>, <em>k</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/utils.html#annotation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.utils.annotation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="janitor.utils.chunks">
<code class="descclassname">janitor.utils.</code><code class="descname">chunks</code><span class="sig-paren">(</span><em>iterable</em>, <em>size=50</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/utils.html#chunks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.utils.chunks" title="Permalink to this definition">¶</a></dt>
<dd><p>Break an iterable into lists of size</p>
</dd></dl>

<dl class="function">
<dt id="janitor.utils.dumps">
<code class="descclassname">janitor.utils.</code><code class="descname">dumps</code><span class="sig-paren">(</span><em>data</em>, <em>fh=None</em>, <em>indent=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/utils.html#dumps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.utils.dumps" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="janitor.utils.loads">
<code class="descclassname">janitor.utils.</code><code class="descname">loads</code><span class="sig-paren">(</span><em>body</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/utils.html#loads"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.utils.loads" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="janitor.utils.local_session">
<code class="descclassname">janitor.utils.</code><code class="descname">local_session</code><span class="sig-paren">(</span><em>factory</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/utils.html#local_session"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.utils.local_session" title="Permalink to this definition">¶</a></dt>
<dd><p>Cache a session thread local for up 45m</p>
</dd></dl>

<dl class="function">
<dt id="janitor.utils.parse_s3">
<code class="descclassname">janitor.utils.</code><code class="descname">parse_s3</code><span class="sig-paren">(</span><em>s3_path</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/utils.html#parse_s3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.utils.parse_s3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="janitor.utils.query_instances">
<code class="descclassname">janitor.utils.</code><code class="descname">query_instances</code><span class="sig-paren">(</span><em>session</em>, <em>client=None</em>, <em>**query</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/utils.html#query_instances"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.utils.query_instances" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of ec2 instances for the query.</p>
</dd></dl>

<dl class="function">
<dt id="janitor.utils.set_annotation">
<code class="descclassname">janitor.utils.</code><code class="descname">set_annotation</code><span class="sig-paren">(</span><em>i</em>, <em>k</em>, <em>v</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/janitor/utils.html#set_annotation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janitor.utils.set_annotation" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">set_annotation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;marker&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annotation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;marker&#39;</span><span class="p">)</span>
<span class="go">[&#39;a&#39;]</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-janitor.version">
<span id="janitor-version-module"></span><h2>janitor.version module<a class="headerlink" href="#module-janitor.version" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-janitor">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-janitor" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          <ul>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../architecture.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer.html">Developer Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../filter-values.html">Value Filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ec2.html">EC2 Policy Definition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../s3.html">S3 Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../comparisons.html">Comparisons</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lambda.html">Lambda Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../offhours.html">Offhours support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../offhours.html#tag-based-configuration">Tag Based Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../offhours.html#policy-examples">Policy examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../offhours.html#options">Options</a></li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="../search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
            <p class="searchtip" style="font-size: 90%">
                Enter search terms or a module, class or function name.
            </p>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="../py-modindex.html" title="Python Module Index"
              >modules</a> |
            <a href="../genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
              <br/>
              <a href="../_sources/generated/janitor.txt"
                rel="nofollow">Show Source</a>
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, Kapil Thangavelu.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.3.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>